{"version":3,"file":"IPFSSubpathRedirect.js","sourceRoot":"","sources":["../../ts/components/IPFSSubpathRedirect.tsx"],"names":[],"mappings":";AAAA,OAAO,EAAE,GAAG,EAAE,MAAM,cAAc,CAAA;AAClC,OAAO,EAAE,SAAS,EAAE,MAAM,cAAc,CAAA;AAExC,MAAM,CAAC,MAAM,mBAAmB,GAAG,GAAG,EAAE;IACvC,SAAS,uBAAuB;QAC/B,MAAM,QAAQ,GAAG,QAAQ,CAAC,aAAa,CAAC,MAAM,CAAC,CAAA;QAC/C,IAAI,CAAC,QAAQ,IAAI,CAAC,QAAQ,CAAC,IAAI,CAAC,QAAQ,CAAC,QAAQ,CAAC;YAAE,OAAM;QAC1D,MAAM,QAAQ,GAAG,kHAAkH,CAAA;QACnI,MAAM,CAAC,CAAC,EAAE,aAAa,CAAC,GAAG,QAAQ,CAAC,IAAI,CAAC,KAAK,CAAC,QAAQ,CAAC,IAAI,EAAE,CAAA;QAC9D,OAAO,aAAa,CAAA;IACrB,CAAC;IAED,SAAS,uBAAuB;QAC/B,MAAM,WAAW,GAAG,uBAAuB,EAAE,CAAA;QAE7C,IAAI,CAAC,WAAW;YAAE,OAAM;QAExB,MAAM,WAAW,GAAG,GAAG,CAAC,KAAK,CAAC,WAAW,CAAC,CAAC,IAAI,EAAE,CAAC,QAAQ,EAAE,CAAA;QAC5D,IAAI,CAAC,WAAW;YAAE,OAAM;QACxB,OAAO,GAAG,QAAQ,CAAC,QAAQ,KAAK,WAAW,SAAS,QAAQ,CAAC,IAAI,EAAE,CAAA;IACpE,CAAC;IAED,SAAS,CAAC,GAAG,EAAE;QACd,MAAM,WAAW,GAAG,uBAAuB,EAAE,CAAA;QAC7C,IAAI,CAAC,WAAW;YAAE,OAAM;QACxB,MAAM,CAAC,QAAQ,CAAC,IAAI,GAAG,WAAW,CAAA;IACnC,CAAC,EAAE,EAAE,CAAC,CAAA;IAEN,OAAO,mBAAK,CAAA;AACb,CAAC,CAAA","sourcesContent":["import { CID } from 'multiformats'\nimport { useEffect } from 'preact/hooks'\n\nexport const IPFSSubpathRedirect = () => {\n\tfunction extractHashFromBasePath() {\n\t\tconst htmlBase = document.querySelector('base')\n\t\tif (!htmlBase || !htmlBase.href.includes('/ipfs/')) return\n\t\tconst cidRegex = /\\/ipfs\\/(Qm[1-9A-HJ-NP-Za-km-z]{44,}|b[A-Za-z2-7]{58,}|B[A-Z2-7]{58,}|z[1-9A-HJ-NP-Za-km-z]{48,}|F[0-9A-F]{50,})/\n\t\tconst [_, maybeCidMatch] = htmlBase.href.match(cidRegex) || []\n\t\treturn maybeCidMatch\n\t}\n\n\tfunction generateIPFSRedirectUrl() {\n\t\tconst cidFromPath = extractHashFromBasePath()\n\n\t\tif (!cidFromPath) return\n\n\t\tconst v1CidString = CID.parse(cidFromPath).toV1().toString()\n\t\tif (!v1CidString) return\n\t\treturn `${location.protocol}//${v1CidString}.ipfs.${location.host}`\n\t}\n\n\tuseEffect(() => {\n\t\tconst redirectUrl = generateIPFSRedirectUrl()\n\t\tif (!redirectUrl) return\n\t\twindow.location.href = redirectUrl\n\t}, [])\n\n\treturn <></>\n}\n"]}