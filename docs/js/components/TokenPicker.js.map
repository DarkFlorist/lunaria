{"version":3,"file":"TokenPicker.js","sourceRoot":"","sources":["../../ts/components/TokenPicker.tsx"],"names":[],"mappings":"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","sourcesContent":["import { batch, Signal, useComputed, useSignal, useSignalEffect } from '@preact/signals'\nimport { Contract } from 'ethers'\nimport { useRef } from 'preact/hooks'\nimport { useTokenManager } from '../context/TokenManager.js'\nimport { useTransfer } from '../context/Transfer.js'\nimport { useEthereumProvider } from '../context/Ethereum.js'\nimport { ERC20ABI } from '../library/ERC20ABI.js'\nimport { useAsyncState, useSignalRef } from '../library/preact-utilities.js'\nimport { removeNonStringsAndTrim, stringIncludes } from '../library/utilities.js'\nimport { ERC20Token, HexString } from '../schema.js'\nimport { AsyncText } from './AsyncText.js'\nimport * as Icon from './Icon/index.js'\nimport { useWallet } from '../context/Wallet.js'\nimport { AbbreviatedValue } from './AbbreviatedValue.js'\n\nexport const TokenPicker = () => {\n\tconst { ref, signal: dialogRef } = useSignalRef<HTMLDialogElement | null>(null)\n\tconst { query, stage } = useTokenManager()\n\n\tconst closeDialogOnBackdropClick = (e: Event) => {\n\t\tconst isClickWithinDialog = e.type === 'click' && e.target !== dialogRef?.value\n\t\tif (isClickWithinDialog) return\n\t\tdialogRef.value?.close()\n\t}\n\n\tconst unsetStageIfClosedIntentionally = () => {\n\t\tstage.value = stage.value === 'select' ? undefined : stage.value\n\t}\n\n\tconst showOrHideDialog = () => {\n\t\tconst dialogElement = dialogRef.value\n\t\tconst isDialogOpen = stage.value === 'select'\n\t\tif (!dialogElement) return\n\t\tdialogElement.onclose = unsetStageIfClosedIntentionally\n\t\tdialogElement[isDialogOpen ? 'showModal' : 'close']()\n\t}\n\n\tconst setClickListenerForDialog = () => {\n\t\tif (stage.value !== 'select') return\n\t\tdocument.addEventListener('click', closeDialogOnBackdropClick)\n\t\treturn () => document.removeEventListener('click', closeDialogOnBackdropClick)\n\t}\n\n\tuseSignalEffect(showOrHideDialog)\n\tuseSignalEffect(setClickListenerForDialog)\n\n\treturn (\n\t\t<dialog ref={ref} class='w-full text-white backdrop:bg-black/80 backdrop:backdrop-blur-[2px] max-w-full max-h-full md:max-w-fit md:max-h-[calc(100vh-3rem)] md:max-w-fit bg-transparent'>\n\t\t\t<div class='text-2xl font-semibold px-4 pt-5 leading-0'>Select Asset</div>\n\t\t\t<form method='dialog'>\n\t\t\t\t<div class='sticky top-0 p-4 bg-black/50 z-10 backdrop-blur-[2px]'>\n\t\t\t\t\t<SearchField query={query} />\n\t\t\t\t</div>\n\t\t\t\t<AssetCardList />\n\t\t\t</form>\n\t\t</dialog>\n\t)\n}\n\nconst AssetCardList = () => {\n\tconst { cache } = useTokenManager()\n\tconst { input } = useTransfer()\n\tconst { query } = useTokenManager()\n\tconst { network } = useEthereumProvider()\n\n\tconst activeChainId = useComputed(() => (network.value.state === 'resolved' ? network.value.value.chainId : 1n))\n\n\tconst matchTokensInChain = (token: ERC20Token) => token.chainId === activeChainId.value\n\tconst matchQueriedTokens = (token: ERC20Token) => stringIncludes(token.name, query.value) || stringIncludes(token.symbol, query.value)\n\n\tconst tokensList = useComputed(() => {\n\t\tconst tokensInChain = cache.value.data.filter(matchTokensInChain)\n\t\treturn tokensInChain.filter(matchQueriedTokens)\n\t})\n\n\tconst gridStyles = useComputed(() => {\n\t\tlet classNames = 'grid-cols-1'\n\t\tconst length = tokensList.value.length + 2\n\t\tif (length > 1) classNames += ' sm:grid-cols-2'\n\t\tif (length > 2) classNames += ' md:grid-cols-3'\n\t\tif (length > 3) classNames += ' lg:grid-cols-4'\n\t\tif (length > 4) classNames += ' xl:grid-cols-5'\n\t\treturn classNames\n\t})\n\n\tuseSignalEffect(() => {\n\t\tinput.value = { ...input.peek(), token: query.value !== '' ? tokensList.value.at(0) : undefined }\n\t})\n\n\treturn (\n\t\t<fieldset class={removeNonStringsAndTrim('px-4 grid gap-4', gridStyles.value)} tabIndex={-1}>\n\t\t\t{query.value === '' || stringIncludes('ethers', query.value) ? <AssetCard /> : <></>}\n\t\t\t{tokensList.value.map(token => (\n\t\t\t\t<AssetCard key={token.address} token={token} />\n\t\t\t))}\n\t\t\t<AddTokenOrConnectCard />\n\t\t</fieldset>\n\t)\n}\n\nconst AssetCard = ({ token }: { token?: ERC20Token }) => {\n\tconst radioRef = useRef<HTMLInputElement>(null)\n\tconst { stage } = useTokenManager()\n\tconst { input } = useTransfer()\n\tconst iconPath = token ? `./img/${token.address.toLowerCase()}.svg` : `./img/ethereum.svg`\n\n\tconst setId = 'transfer_asset'\n\tconst uniqueId = token?.address || 'ether'\n\n\tconst isSelected = useComputed(() => input.value.token?.address === token?.address)\n\n\tconst inputEventHandler = (e: Event) => {\n\t\tif (e instanceof FocusEvent) {\n\t\t\tinput.value = { ...input.peek(), token }\n\t\t\treturn\n\t\t}\n\n\t\tif (e instanceof KeyboardEvent && e.key === 'Enter') {\n\t\t\tstage.value = undefined\n\t\t\treturn\n\t\t}\n\t}\n\n\tconst selectAssetAndExitManager = () =>\n\t\tbatch(() => {\n\t\t\tinput.value = { ...input.peek(), token }\n\t\t\tstage.value = undefined\n\t\t})\n\n\treturn (\n\t\t<div class='relative aspect-[16/9] md:aspect-[4/5] md:min-w-[14em] bg-neutral-900 hover:bg-neutral-800'>\n\t\t\t<input id={uniqueId} ref={radioRef} type='radio' name={setId} checked={isSelected.value} autofocus={isSelected.value} tabIndex={1} onFocus={inputEventHandler} onKeyDown={inputEventHandler} class='peer absolute w-0 h-0 appearance-none' />\n\t\t\t<label for={uniqueId} class='grid grid-rows-[1fr,min-content] h-full p-4 border border-transparent peer-checked:border-white/50 peer-checked:peer-focus:border-white opacity-50 peer-checked:opacity-100 hover:opacity-100 cursor-pointer' onClick={selectAssetAndExitManager}>\n\t\t\t\t<div class='row-start-2 grid grid-cols-[min-content,1fr] gap-x-3 gap-y-1 items-center'>\n\t\t\t\t\t<object class='w-12 h-12 bg-white rounded-full overflow-hidden mb-1' data={iconPath} type='image/svg+xml' tabIndex={-1}>\n\t\t\t\t\t\t<div class='bg-white text-gray-900 font-bold text-lg w-full h-full flex items-center justify-center uppercase'>{token?.name.substring(0, 2)}</div>\n\t\t\t\t\t</object>\n\t\t\t\t\t<div class='text-whte/50'>{token?.symbol || 'ETH'}</div>\n\t\t\t\t\t<div class='col-span-full'>{token?.name || 'Ether'}</div>\n\t\t\t\t\t<div class='col-span-full text-white/50'>\n\t\t\t\t\t\t<AssetBalance token={token} />\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\t\t\t</label>\n\t\t\t{token ? <RemoveAssetDialog token={token} /> : <></>}\n\t\t</div>\n\t)\n}\n\nconst AssetBalance = ({ token }: { token?: ERC20Token }) => {\n\tconst { stage } = useTokenManager()\n\tconst { browserProvider, blockNumber } = useEthereumProvider()\n\tconst { account } = useWallet()\n\tconst { value: query, waitFor } = useAsyncState<bigint>()\n\n\tif (account.value.state !== 'resolved') return <></>\n\tif (!browserProvider) return <></>\n\n\tconst getAssetBalance = async (address: HexString) => {\n\t\tif (!browserProvider.value) return\n\t\tconst provider = browserProvider.value\n\t\tif (!token) {\n\t\t\twaitFor(async () => await provider.getBalance(address))\n\t\t} else {\n\t\t\tconst contract = new Contract(token.address, ERC20ABI, provider)\n\t\t\twaitFor(async () => await contract.balanceOf(address))\n\t\t}\n\t}\n\n\tuseSignalEffect(() => {\n\t\tif (!stage.value || !blockNumber.value || account.value.state !== 'resolved') return\n\t\tgetAssetBalance(account.value.value)\n\t})\n\n\tswitch (query.value.state) {\n\t\tcase 'inactive':\n\t\t\treturn <></>\n\t\tcase 'pending':\n\t\t\treturn <AsyncText placeholderLength={10} />\n\t\tcase 'rejected':\n\t\t\treturn <div>error</div>\n\t\tcase 'resolved':\n\t\t\treturn <><AbbreviatedValue amount={query.value.value} decimals={token?.decimals} /> {token ? token.symbol : 'ETH'}</>\n\t}\n}\n\nconst RemoveAssetDialog = ({ token }: { token: ERC20Token }) => {\n\tconst { cache } = useTokenManager()\n\tconst isRemoving = useSignal(false)\n\n\tconst confirmRemove = () => {\n\t\tcache.value = Object.assign({}, cache.peek(), { data: cache.peek().data.filter(t => t.address !== token.address) })\n\t\tisRemoving.value = false\n\t}\n\n\tconst rejectRemove = () => {\n\t\tisRemoving.value = false\n\t}\n\n\treturn (\n\t\t<div class='group absolute inset-0 p-3 peer-checked:hidden pointer-events-none'>\n\t\t\t<button type='button' class='peer group outline-none px-2 h-8 grid grid-flow-col gap-2 place-items-center absolute top-2 right-2 text-white/30 focus|hover:text-white pointer-events-auto' onClick={() => (isRemoving.value = true)}>\n\t\t\t\t<TrashIcon />\n\t\t\t</button>\n\t\t\t{isRemoving.value ? (\n\t\t\t\t<div class='absolute inset-0 bg-black border border-white text-center p-6 flex items-center justify-center pointer-events-auto'>\n\t\t\t\t\t<div class='w-full'>\n\t\t\t\t\t\t<div class='leading-tight text-white/50 text-sm'>This will remove the contract address for</div>\n\t\t\t\t\t\t<div class='font-semibold'>{token.name}</div>\n\t\t\t\t\t\t<div class='leading-tight text-white/50 text-sm mb-2'>Continue?</div>\n\t\t\t\t\t\t<div class='grid grid-cols-[min-content,min-content] gap-2 place-content-center'>\n\t\t\t\t\t\t\t<button onClick={rejectRemove} type='button' class='border border-white/50 hover:border-white px-3 h-8 text-sm font-semibold uppercase' tabIndex={-1}>\n\t\t\t\t\t\t\t\tno\n\t\t\t\t\t\t\t</button>\n\t\t\t\t\t\t\t<button onClick={confirmRemove} type='button' class='border border-white/50 hover:border-white px-3 h-8 text-sm font-semibold uppercase' tabIndex={-1}>\n\t\t\t\t\t\t\t\tyes\n\t\t\t\t\t\t\t</button>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\t\t\t) : (\n\t\t\t\t<></>\n\t\t\t)}\n\t\t</div>\n\t)\n}\n\nconst AddTokenOrConnectCard = () => {\n\tconst { account } = useWallet()\n\tconst { stage } = useTokenManager()\n\tconst openAddTokenDialog = () => {\n\t\tstage.value = 'add'\n\t}\n\n\tif (account.value.state !== 'resolved') return <></>\n\n\treturn (\n\t\t<div class='relative aspect-[16/9] md:aspect-[4/5] md:min-w-[14em] bg-neutral-900'>\n\t\t\t<button for='transfer_asset_add' class='w-full h-full outline-none border border-transparent opacity-50 focus:opacity-100 hover:opacity-100 focus|hover:bg-neutral-800 cursor-pointer flex items-center justify-center' onClick={openAddTokenDialog} tabIndex={3}>\n\t\t\t\t<div class='grid place-items-center'>\n\t\t\t\t\t<div class='w-16 h-16 rounded-full bg-neutral-600 flex items-center justify-center mb-2'>\n\t\t\t\t\t\t<svg class='text-white/50' width='3em' height='3em' viewBox='0 0 15 15' fill='none' xmlns='http://www.w3.org/2000/svg'>\n\t\t\t\t\t\t\t<path fill-rule='evenodd' clip-rule='evenodd' d='M8 2.75a.5.5 0 0 0-1 0V7H2.75a.5.5 0 0 0 0 1H7v4.25a.5.5 0 0 0 1 0V8h4.25a.5.5 0 0 0 0-1H8V2.75Z' fill='currentColor'></path>\n\t\t\t\t\t\t</svg>\n\t\t\t\t\t</div>\n\t\t\t\t\t<div>New Token</div>\n\t\t\t\t</div>\n\t\t\t</button>\n\t\t</div>\n\t)\n}\n\nconst SearchField = ({ query }: { query: Signal<string> }) => {\n\tconst searchInputRef = useRef<HTMLInputElement>(null)\n\n\tconst clearSearchQuery = () => {\n\t\tquery.value = ''\n\t\tsearchInputRef.current?.focus()\n\t}\n\n\treturn (\n\t\t<div class='border border-white/50 focus-within:border-white bg-black grid grid-cols-[1fr,min-content] items-center gap-2 px-2 h-12'>\n\t\t\t<input ref={searchInputRef} placeholder='Search token' type='search' class='peer appearance-none clear-none outline-none bg-transparent w-full placeholder:text-white/30 focus:border-white min-w-0 px-1' value={query.value} onInput={e => (query.value = e.currentTarget.value)} tabIndex={2} />\n\t\t\t<button type='button' class='peer-placeholder-shown:hidden outline-none text-xs w-8 h-8 flex items-center justify-center border-white focus|hover:border' onClick={clearSearchQuery} tabIndex={-1}>\n\t\t\t\t<Icon.Xmark />\n\t\t\t</button>\n\t\t</div>\n\t)\n}\n\nconst TrashIcon = () => (\n\t<svg width='1em' height='1em' viewBox='0 0 56 56' xmlns='http://www.w3.org/2000/svg'>\n\t\t<path\n\t\t\td='m44.523 48.66 1.618-34.265h2.343c.961 0 1.735-.797 1.735-1.758s-.774-1.782-1.735-1.782H38.242V7.34c0-3.352-2.273-5.531-5.883-5.531h-8.765c-3.61 0-5.86 2.18-5.86 5.53v3.516H7.54c-.937 0-1.758.82-1.758 1.782 0 .96.82 1.758 1.758 1.758h2.344L11.5 48.684c.164 3.375 2.39 5.507 5.766 5.507h21.492c3.351 0 5.601-2.156 5.765-5.53ZM21.484 7.574c0-1.336.985-2.273 2.391-2.273h8.227c1.43 0 2.414.937 2.414 2.273v3.281H21.484Zm-3.867 43.102c-1.36 0-2.367-1.032-2.437-2.39l-1.64-33.892h28.85l-1.546 33.891c-.07 1.383-1.055 2.39-2.438 2.39Zm17.344-4.125c.773 0 1.36-.633 1.383-1.524l.703-24.75c.023-.89-.586-1.547-1.383-1.547-.726 0-1.336.68-1.36 1.524l-.702 24.773c-.024.844.562 1.524 1.359 1.524Zm-13.898 0c.797 0 1.382-.68 1.359-1.524l-.703-24.773c-.024-.844-.656-1.524-1.383-1.524-.797 0-1.383.657-1.36 1.547l.727 24.75c.024.891.586 1.524 1.36 1.524Zm8.367-1.524V20.254c0-.844-.633-1.524-1.407-1.524-.773 0-1.43.68-1.43 1.524v24.773c0 .844.657 1.524 1.43 1.524.75 0 1.407-.68 1.407-1.524Z'\n\t\t\tfill='currentColor'\n\t\t/>\n\t</svg>\n)\n"]}