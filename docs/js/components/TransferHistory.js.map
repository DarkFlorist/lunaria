{"version":3,"file":"TransferHistory.js","sourceRoot":"","sources":["../../ts/components/TransferHistory.tsx"],"names":[],"mappings":";AAAA,OAAO,EAAE,WAAW,EAAE,MAAM,iBAAiB,CAAA;AAC7C,OAAO,EAAE,SAAS,EAAE,MAAM,sBAAsB,CAAA;AAChD,OAAO,EAAE,kBAAkB,EAAE,MAAM,+BAA+B,CAAA;AAElE,OAAO,EAAE,OAAO,EAAE,MAAM,cAAc,CAAA;AACtC,OAAO,EAAE,gBAAgB,EAAE,MAAM,uBAAuB,CAAA;AAExD,MAAM,CAAC,MAAM,eAAe,GAAG,GAAG,EAAE;IACnC,MAAM,OAAO,GAAG,kBAAkB,EAAE,CAAA;IACpC,MAAM,EAAE,OAAO,EAAE,GAAG,SAAS,EAAE,CAAA;IAE/B,MAAM,gBAAgB,GAAG,WAAW,CAAC,GAAG,EAAE,CAAC,CAAC,OAAO,CAAC,KAAK,CAAC,KAAK,KAAK,UAAU,CAAC,CAAC,CAAC,SAAS,CAAC,CAAC,CAAC,OAAO,CAAC,KAAK,CAAC,KAAK,CAAC,CAAC,CAAA;IAElH,MAAM,gCAAgC,GAAG,GAAG,EAAE;QAC7C,OAAO,CACN,OAAO,CAAC,KAAK,CAAC,IAAI;YACjB,6CAA6C;aAC5C,MAAM,CAAC,QAAQ,CAAC,EAAE,CAAC,QAAQ,CAAC,IAAI,KAAK,gBAAgB,CAAC,KAAK,CAAC;YAC7D,+BAA+B;aAC9B,IAAI,CAAC,CAAC,CAAC,EAAE,CAAC,EAAE,EAAE,CAAC,IAAI,IAAI,CAAC,CAAC,CAAC,IAAI,CAAC,CAAC,OAAO,EAAE,GAAG,IAAI,IAAI,CAAC,CAAC,CAAC,IAAI,CAAC,CAAC,OAAO,EAAE,CAAC,CACzE,CAAA;IACF,CAAC,CAAA;IAED,MAAM,yBAAyB,GAAG,WAAW,CAAC,gCAAgC,CAAC,CAAA;IAE/E,OAAO,CACN,eAAK,KAAK,EAAC,WAAW,aACrB,cAAK,KAAK,EAAC,4BAA4B,iCAAuB,EAC9D,KAAC,WAAW,IAAC,SAAS,EAAE,yBAAyB,CAAC,KAAK,GAAI,IACtD,CACN,CAAA;AACF,CAAC,CAAA;AAED,MAAM,WAAW,GAAG,CAAC,EAAE,SAAS,EAA6B,EAAE,EAAE;IAChE,IAAI,SAAS,CAAC,MAAM,GAAG,CAAC;QAAE,OAAO,cAAK,KAAK,EAAC,qHAAqH,sFAA4E,CAAA;IAE7O,OAAO,CACN,wBACE,SAAS,CAAC,GAAG,CAAC,QAAQ,CAAC,EAAE;YACzB,MAAM,SAAS,GAAG,IAAI,IAAI,CAAC,QAAQ,CAAC,IAAI,CAAC,CAAC,OAAO,EAAE,CAAA;YACnD,OAAO,CACN,aAAG,KAAK,EAAC,oDAAoD,EAAC,IAAI,EAAE,OAAO,QAAQ,CAAC,IAAI,EAAE,aACzF,eAAK,KAAK,EAAC,iDAAiD,sBACtD,KAAC,gBAAgB,IAAC,MAAM,EAAE,QAAQ,CAAC,MAAM,EAAE,QAAQ,EAAE,QAAQ,CAAC,KAAK,EAAE,QAAQ,GAAI,OAAE,QAAQ,CAAC,KAAK,EAAE,IAAI,IAAI,KAAK,UAAM,QAAQ,CAAC,EAAE,IACjI,EACN,cAAK,KAAK,EAAC,uBAAuB,YACjC,KAAC,OAAO,IAAC,KAAK,EAAE,SAAS,GAAI,GACxB,IACH,CACJ,CAAA;QACF,CAAC,CAAC,GACG,CACN,CAAA;AACF,CAAC,CAAA","sourcesContent":["import { useComputed } from '@preact/signals'\nimport { useWallet } from '../context/Wallet.js'\nimport { useTransferHistory } from '../context/TransferHistory.js'\nimport { Transfer } from '../schema.js'\nimport { TimeAgo } from './TimeAgo.js'\nimport { AbbreviatedValue } from './AbbreviatedValue.js'\n\nexport const TransferHistory = () => {\n\tconst history = useTransferHistory()\n\tconst { account } = useWallet()\n\n\tconst connectedAddress = useComputed(() => (account.value.state !== 'resolved' ? undefined : account.value.value))\n\n\tconst getTransfersFromConnectedAddress = () => {\n\t\treturn (\n\t\t\thistory.value.data\n\t\t\t\t// select only history from connected account\n\t\t\t\t.filter(transfer => transfer.from === connectedAddress.value)\n\t\t\t\t// sort by recent transfer date\n\t\t\t\t.sort((a, b) => new Date(b.date).getTime() - new Date(a.date).getTime())\n\t\t)\n\t}\n\n\tconst connectedAddressTransfers = useComputed(getTransfersFromConnectedAddress)\n\n\treturn (\n\t\t<div class='pl-4 mb-4'>\n\t\t\t<div class='text-white/30 text-sm mb-2'>Recent Transfers</div>\n\t\t\t<HistoryList transfers={connectedAddressTransfers.value} />\n\t\t</div>\n\t)\n}\n\nconst HistoryList = ({ transfers }: { transfers: Transfer[] }) => {\n\tif (transfers.length < 1) return <div class='border border-dashed border-white/30 px-4 h-16 text-sm text-white/50 flex items-center justify-center leading-tight'>A history of transfers will be stored locally on the current browser.</div>\n\n\treturn (\n\t\t<div>\n\t\t\t{transfers.map(transfer => {\n\t\t\t\tconst timeStamp = new Date(transfer.date).getTime()\n\t\t\t\treturn (\n\t\t\t\t\t<a class='block bg-white/10 px-4 py-3 mb-1 hover:bg-white/20' href={`#tx/${transfer.hash}`}>\n\t\t\t\t\t\t<div class='overflow-hidden text-ellipsis whitespace-nowrap'>\n\t\t\t\t\t\t\tSent <AbbreviatedValue amount={transfer.amount} decimals={transfer.token?.decimals} /> {transfer.token?.name || 'ETH'} to {transfer.to}\n\t\t\t\t\t\t</div>\n\t\t\t\t\t\t<div class='text-sm text-white/50'>\n\t\t\t\t\t\t\t<TimeAgo since={timeStamp} />\n\t\t\t\t\t\t</div>\n\t\t\t\t\t</a>\n\t\t\t\t)\n\t\t\t})}\n\t\t</div>\n\t)\n}\n"]}