{"version":3,"file":"TransferResult.js","sourceRoot":"","sources":["../../ts/components/TransferResult.tsx"],"names":[],"mappings":"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","sourcesContent":["import { useComputed } from '@preact/signals'\nimport { useWallet } from '../context/Wallet.js'\nimport { useNotification } from '../context/Notification.js'\nimport { useTokenManager } from '../context/TokenManager.js'\nimport { useTransfer } from '../context/Transfer.js'\nimport { humanReadableEthersError, isEthersError } from '../library/errors.js'\nimport { areEqualStrings } from '../library/utilities.js'\nimport { CopyButton } from './CopyButton.js'\n\nexport const TransferResult = () => {\n\tconst { account } = useWallet()\n\tconst { input, transaction } = useTransfer()\n\tconst { cache: tokensCache } = useTokenManager()\n\tconst { notify } = useNotification()\n\n\tconst recipientIsSender = useComputed(() => {\n\t\tif (account.value.state !== 'resolved') return false\n\t\treturn account.value.value === input.value.to\n\t})\n\n\tconst recipientIsAKnownToken = useComputed(() => tokensCache.value.data.some(token => areEqualStrings(token.address, input.value.to)))\n\n\tswitch (transaction.value.state) {\n\t\tcase 'inactive':\n\t\t\tif (recipientIsSender.value) {\n\t\t\t\treturn <ConfirmField title='Warning: The recipient is the same as the sender' description='This transactions sends funds to itself and will almost certainly result wasting money on transaction fees.' label='I understand that this will almost certainly have no effect but still cost me transactions fees.' />\n\t\t\t}\n\t\t\tif (recipientIsAKnownToken.value) {\n\t\t\t\treturn <ConfirmField title='Warning: Recipient is a token address' description='The recipient address provided is a token contract address and will probably result in a loss of funds.' label='I understand that this will probably result in a loss of funds.' />\n\t\t\t}\n\t\t\treturn <></>\n\t\tcase 'rejected':\n\t\t\tconst txError = transaction.value.error\n\t\t\tlet errorMessage = 'An unknown error occurred'\n\n\t\t\tif (isEthersError(txError)) {\n\t\t\t\tconst { warning, message } = humanReadableEthersError(txError)\n\n\t\t\t\tif (!warning) {\n\t\t\t\t\tnotify({ message, title: 'Action Rejected' })\n\t\t\t\t\treturn <></>\n\t\t\t\t}\n\n\t\t\t\terrorMessage = message\n\t\t\t}\n\n\t\t\treturn <ErrorDetails summary={ errorMessage } message={ txError.message } />\n\t\tcase 'resolved':\n\t\tcase 'pending':\n\t\t\treturn <></>\n\t}\n}\n\nconst ErrorDetails = ({ message, summary }: { message: string, summary: string }) => {\n\treturn (\n\t\t<div class='border border-red-400/50 bg-red-400/10 px-4 py-3 grid grid-cols-[min-content,1fr] gap-x-3 items-center min-w-0'>\n\t\t\t<div>\n\t\t\t\t<ExclamationIcon />\n\t\t\t</div>\n\t\t\t<div class='min-w-0'>\n\t\t\t\t<div class='font-semibold'>Transaction failed!</div>\n\t\t\t\t<div class='text-sm text-white/50 break-words'>{ summary }</div>\n\t\t\t\t<details class='group'>\n\t\t\t\t\t<summary class='cursor-pointer before:content-[\"Show\"] group-[:is([open])]:before:content-[\"Hide\"]'> details</summary>\n\t\t\t\t\t<div class='border border-white/10 bg-white/5 px-3 py-2 mt-2 group relative'>\n\t\t\t\t\t\t<pre class='whitespace-pre-wrap text-sm text-white/30'>{ message }</pre>\n\t\t\t\t\t\t<div class='absolute right-2 bottom-2 hidden group-hover:block'>\n\t\t\t\t\t\t\t<CopyButton value={ message } withLabel />\n\t\t\t\t\t\t</div>\n\t\t\t\t\t</div>\n\t\t\t\t</details>\n\t\t\t</div>\n\t\t</div>\n\t)\n}\n\ntype ConfirmFieldProps = {\n\ttitle: string\n\tdescription: string\n\tlabel: string\n}\n\nconst ConfirmField = ({ title, description, label }: ConfirmFieldProps) => {\n\treturn (\n\t\t<div class='border border-amber-500/50 bg-amber-500/10 px-4 py-3 grid grid-cols-[min-content,1fr] grid-rows-[min-content,min-content] gap-x-3 items-center'>\n\t\t\t<div class='row-span-2'>\n\t\t\t\t<ExclamationIcon />\n\t\t\t</div>\n\t\t\t<div>\n\t\t\t\t<div class='font-semibold leading-tight'>{ title }</div>\n\t\t\t\t<div class='text-sm text-white/50 mb-2 leading-tight'>{ description }</div>\n\t\t\t</div>\n\t\t\t<label class='grid grid-cols-[min-content,1fr] gap-x-3 items-start'>\n\t\t\t\t<input class='h-5' type='checkbox' required />\n\t\t\t\t<span class='leading-tight'>{ label }</span>\n\t\t\t</label>\n\t\t</div>\n\t)\n}\n\nconst ExclamationIcon = () => (\n\t<svg width='1em' height='1em' viewBox='0 0 24 24' fill='none' xmlns='http://www.w3.org/2000/svg' class='text-4xl'>\n\t\t<path\n\t\t\td='M12 17.5C12.3117 17.5 12.5731 17.3944 12.7843 17.1832C12.9948 16.9727 13.1 16.7117 13.1 16.4V11.9725C13.1 11.6608 12.9948 11.4042 12.7843 11.2025C12.5731 11.0008 12.3117 10.9 12 10.9C11.6883 10.9 11.4273 11.0052 11.2168 11.2157C11.0056 11.4269 10.9 11.6883 10.9 12V16.4275C10.9 16.7392 11.0056 16.9958 11.2168 17.1975C11.4273 17.3992 11.6883 17.5 12 17.5V17.5ZM12 8.7C12.3117 8.7 12.5731 8.5944 12.7843 8.3832C12.9948 8.17273 13.1 7.91167 13.1 7.6C13.1 7.28833 12.9948 7.0269 12.7843 6.8157C12.5731 6.60523 12.3117 6.5 12 6.5C11.6883 6.5 11.4273 6.60523 11.2168 6.8157C11.0056 7.0269 10.9 7.28833 10.9 7.6C10.9 7.91167 11.0056 8.17273 11.2168 8.3832C11.4273 8.5944 11.6883 8.7 12 8.7ZM12 23C10.4783 23 9.04833 22.7111 7.71 22.1332C6.37167 21.5561 5.2075 20.7725 4.2175 19.7825C3.2275 18.7925 2.44393 17.6283 1.8668 16.29C1.28893 14.9517 1 13.5217 1 12C1 10.4783 1.28893 9.04833 1.8668 7.71C2.44393 6.37167 3.2275 5.2075 4.2175 4.2175C5.2075 3.2275 6.37167 2.44357 7.71 1.8657C9.04833 1.28857 10.4783 1 12 1C13.5217 1 14.9517 1.28857 16.29 1.8657C17.6283 2.44357 18.7925 3.2275 19.7825 4.2175C20.7725 5.2075 21.5561 6.37167 22.1332 7.71C22.7111 9.04833 23 10.4783 23 12C23 13.5217 22.7111 14.9517 22.1332 16.29C21.5561 17.6283 20.7725 18.7925 19.7825 19.7825C18.7925 20.7725 17.6283 21.5561 16.29 22.1332C14.9517 22.7111 13.5217 23 12 23ZM12 20.8C14.4383 20.8 16.5148 19.9431 18.2293 18.2293C19.9431 16.5148 20.8 14.4383 20.8 12C20.8 9.56167 19.9431 7.48523 18.2293 5.7707C16.5148 4.0569 14.4383 3.2 12 3.2C9.56167 3.2 7.4856 4.0569 5.7718 5.7707C4.05727 7.48523 3.2 9.56167 3.2 12C3.2 14.4383 4.05727 16.5148 5.7718 18.2293C7.4856 19.9431 9.56167 20.8 12 20.8Z'\n\t\t\tfill='white'\n\t\t></path>\n\t</svg>\n)\n"]}