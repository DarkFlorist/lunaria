{"version":3,"file":"Notification.js","sourceRoot":"","sources":["../../ts/context/Notification.tsx"],"names":[],"mappings":";AAAA,OAAO,EAAqB,aAAa,EAAE,MAAM,QAAQ,CAAA;AACzD,OAAO,EAAU,SAAS,EAAE,eAAe,EAAE,MAAM,iBAAiB,CAAA;AACpE,OAAO,EAAE,UAAU,EAAE,SAAS,EAAE,MAAM,cAAc,CAAA;AACpD,OAAO,EAAE,YAAY,EAAE,MAAM,gCAAgC,CAAA;AAa7D,MAAM,mBAAmB,GAAG,aAAa,CAAkC,SAAS,CAAC,CAAA;AAErF,MAAM,CAAC,MAAM,oBAAoB,GAAG,CAAC,EAAE,QAAQ,EAAmC,EAAE,EAAE;IACrF,MAAM,aAAa,GAAG,SAAS,CAAiB,EAAE,CAAC,CAAA;IAEnD,eAAe,CAAC,GAAG,EAAE;QACpB,IAAI,CAAC,aAAa,CAAC,KAAK,CAAC,MAAM;YAAE,OAAM;IACxC,CAAC,CAAC,CAAA;IAEF,OAAO,CACN,MAAC,mBAAmB,CAAC,QAAQ,IAAC,KAAK,EAAE,EAAE,aAAa,EAAE,aACpD,QAAQ,EACT,KAAC,kBAAkB,KAAG,IACQ,CAC/B,CAAA;AACF,CAAC,CAAA;AAED,MAAM,UAAU,eAAe;IAC9B,MAAM,OAAO,GAAG,UAAU,CAAC,mBAAmB,CAAC,CAAA;IAC/C,IAAI,CAAC,OAAO;QAAE,MAAM,IAAI,KAAK,CAAC,0EAA0E,CAAC,CAAA;IAEzG,MAAM,MAAM,GAAG,CAAC,YAAsC,EAAE,EAAE;QACzD,MAAM,SAAS,GAAG,EAAE,EAAE,EAAE,IAAI,CAAC,GAAG,EAAE,EAAE,GAAG,YAAY,EAAE,CAAA;QACrD,OAAO,CAAC,aAAa,CAAC,KAAK,GAAG,OAAO,CAAC,aAAa,CAAC,IAAI,EAAE,CAAC,MAAM,CAAC,CAAC,SAAS,CAAC,CAAC,CAAA;IAC/E,CAAC,CAAA;IAED,MAAM,KAAK,GAAG,GAAG,EAAE;QAClB,OAAO,CAAC,aAAa,CAAC,KAAK,CAAC,KAAK,EAAE,CAAA;IACpC,CAAC,CAAA;IAED,OAAO,EAAE,GAAG,OAAO,EAAE,MAAM,EAAE,KAAK,EAAE,CAAA;AACrC,CAAC;AAED,MAAM,kBAAkB,GAAG,GAAG,EAAE;IAC/B,MAAM,EAAE,GAAG,EAAE,MAAM,EAAE,SAAS,EAAE,GAAG,YAAY,CAA2B,IAAI,CAAC,CAAA;IAC/E,MAAM,EAAE,aAAa,EAAE,GAAG,eAAe,EAAE,CAAA;IAE3C,eAAe,CAAC,GAAG,EAAE;QACpB,MAAM,aAAa,GAAG,SAAS,CAAC,KAAK,CAAA;QACrC,IAAI,CAAC,aAAa;YAAE,OAAM;QAC1B,IAAI,aAAa,CAAC,KAAK,CAAC,MAAM,EAAE;YAC/B,aAAa,CAAC,IAAI,EAAE,CAAA;SACpB;aAAM;YACN,aAAa,CAAC,KAAK,EAAE,CAAA;SACrB;IACF,CAAC,CAAC,CAAA;IAEF,OAAO,CACN,iBAAQ,GAAG,EAAE,GAAG,EAAE,KAAK,EAAC,kCAAkC,YACzD,cAAK,KAAK,EAAC,cAAc,YACvB,aAAa,CAAC,KAAK,CAAC,GAAG,CAAC,YAAY,CAAC,EAAE,CAAC,CACxC,KAAC,YAAY,IAAC,YAAY,EAAE,YAAY,GAAI,CAC5C,CAAC,GACG,GACE,CACT,CAAA;AACF,CAAC,CAAA;AAED,MAAM,YAAY,GAAG,CAAC,EAAE,YAAY,EAAkC,EAAE,EAAE;IACzE,MAAM,EAAE,aAAa,EAAE,GAAG,eAAe,EAAE,CAAA;IAC3C,MAAM,EAAE,EAAE,EAAE,KAAK,EAAE,OAAO,EAAE,QAAQ,EAAE,GAAG,YAAY,CAAA;IAErD,MAAM,YAAY,GAAG,CAAC,EAAU,EAAE,EAAE;QACnC,aAAa,CAAC,KAAK,GAAG,aAAa,CAAC,IAAI,EAAE,CAAC,MAAM,CAAC,CAAC,CAAC,EAAE,CAAC,CAAC,CAAC,EAAE,KAAK,EAAE,CAAC,CAAA;IACpE,CAAC,CAAA;IAED,SAAS,CAAC,GAAG,EAAE;QACd,UAAU,CAAC,GAAG,EAAE,CAAC,YAAY,CAAC,EAAE,CAAC,EAAE,QAAQ,IAAI,IAAI,CAAC,CAAA;IACrD,CAAC,EAAE,EAAE,CAAC,CAAA;IAEN,OAAO,CACN,eAAK,KAAK,EAAC,4DAA4D,aACtE,eAAK,KAAK,EAAC,YAAY,aACtB,cAAK,KAAK,EAAC,eAAe,YAAE,KAAK,GAAO,EACxC,cAAK,KAAK,EAAC,uBAAuB,YAAE,OAAO,GAAO,IAC7C,EACN,iBAAQ,KAAK,EAAC,iFAAiF,EAAC,OAAO,EAAE,GAAG,EAAE,CAAC,YAAY,CAAC,EAAE,CAAC,uBAAkB,IAC5I,CACN,CAAA;AACF,CAAC,CAAA","sourcesContent":["import { ComponentChildren, createContext } from 'preact'\nimport { Signal, useSignal, useSignalEffect } from '@preact/signals'\nimport { useContext, useEffect } from 'preact/hooks'\nimport { useSignalRef } from '../library/preact-utilities.js'\n\ntype Notification = {\n\tid: number\n\tmessage: string\n\ttitle: string\n\tduration?: number\n}\n\ntype NotificationContext = {\n\tnotifications: Signal<Notification[]>\n}\n\nconst NotificationContext = createContext<NotificationContext | undefined>(undefined)\n\nexport const NotificationProvider = ({ children }: { children: ComponentChildren }) => {\n\tconst notifications = useSignal<Notification[]>([])\n\n\tuseSignalEffect(() => {\n\t\tif (!notifications.value.length) return\n\t})\n\n\treturn (\n\t\t<NotificationContext.Provider value={{ notifications }}>\n\t\t\t{children}\n\t\t\t<NotificationCenter />\n\t\t</NotificationContext.Provider>\n\t)\n}\n\nexport function useNotification() {\n\tconst context = useContext(NotificationContext)\n\tif (!context) throw new Error('useNotification can only be used within children of NotificationProvider')\n\n\tconst notify = (Notification: Omit<Notification, 'id'>) => {\n\t\tconst newNotice = { id: Date.now(), ...Notification }\n\t\tcontext.notifications.value = context.notifications.peek().concat([newNotice])\n\t}\n\n\tconst shift = () => {\n\t\tcontext.notifications.value.shift()\n\t}\n\n\treturn { ...context, notify, shift }\n}\n\nconst NotificationCenter = () => {\n\tconst { ref, signal: dialogRef } = useSignalRef<HTMLDialogElement | null>(null)\n\tconst { notifications } = useNotification()\n\n\tuseSignalEffect(() => {\n\t\tconst dialogElement = dialogRef.value\n\t\tif (!dialogElement) return\n\t\tif (notifications.value.length) {\n\t\t\tdialogElement.show()\n\t\t} else {\n\t\t\tdialogElement.close()\n\t\t}\n\t})\n\n\treturn (\n\t\t<dialog ref={ref} class='absolute bottom-4 bg-transparent'>\n\t\t\t<div class='grid gap-y-2'>\n\t\t\t\t{notifications.value.map(notification => (\n\t\t\t\t\t<Notification notification={notification} />\n\t\t\t\t))}\n\t\t\t</div>\n\t\t</dialog>\n\t)\n}\n\nconst Notification = ({ notification }: { notification: Notification }) => {\n\tconst { notifications } = useNotification()\n\tconst { id, title, message, duration } = notification\n\n\tconst removeNotice = (id: number) => {\n\t\tnotifications.value = notifications.peek().filter(n => n.id !== id)\n\t}\n\n\tuseEffect(() => {\n\t\tsetTimeout(() => removeNotice(id), duration || 3000)\n\t}, [])\n\n\treturn (\n\t\t<div class='bg-neutral-900 text-white grid grid-cols-[1fr,min-content]'>\n\t\t\t<div class='px-4 py-3 '>\n\t\t\t\t<div class='font-semibold'>{title}</div>\n\t\t\t\t<div class='text-sm text-white/50'>{message}</div>\n\t\t\t</div>\n\t\t\t<button class='text-white/50 focus|hover:text-white w-10 h-10 flex items-center justify-center' onClick={() => removeNotice(id)}>&times;</button>\n\t\t</div>\n\t)\n}\n"]}