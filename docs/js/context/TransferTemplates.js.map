{"version":3,"file":"TransferTemplates.js","sourceRoot":"","sources":["../../ts/context/TransferTemplates.tsx"],"names":[],"mappings":";AAAA,OAAO,EAAU,SAAS,EAAE,MAAM,iBAAiB,CAAA;AACnD,OAAO,EAAqB,aAAa,EAAE,MAAM,QAAQ,CAAA;AACzD,OAAO,EAAE,UAAU,EAAE,MAAM,cAAc,CAAA;AACzC,OAAO,EAAE,mBAAmB,EAAE,MAAM,yBAAyB,CAAA;AAC7D,OAAO,EAAE,mBAAmB,EAAE,MAAM,iCAAiC,CAAA;AACrE,OAAO,EAAE,iBAAiB,EAAkB,oBAAoB,EAAoB,MAAM,cAAc,CAAA;AAMxG,MAAM,CAAC,MAAM,gBAAgB,GAAG,aAAa,CAA+B,SAAS,CAAC,CAAA;AACtF,MAAM,CAAC,MAAM,iBAAiB,GAAG,CAAC,EAAE,QAAQ,EAAmC,EAAE,EAAE;IAClF,MAAM,KAAK,GAAG,SAAS,CAAiB,EAAE,IAAI,EAAE,EAAE,EAAE,OAAO,EAAE,OAAO,EAAE,CAAC,CAAA;IAEvE,mBAAmB,CAAC,mBAAmB,EAAE,KAAK,EAAE,iBAAiB,CAAC,oBAAoB,CAAC,CAAC,CAAA;IAExF,OAAO,CACN,KAAC,gBAAgB,CAAC,QAAQ,IAAC,KAAK,EAAE,EAAE,KAAK,EAAE,YACzC,QAAQ,GACkB,CAC5B,CAAA;AACF,CAAC,CAAA;AAED,MAAM,UAAU,YAAY;IAC3B,MAAM,OAAO,GAAG,UAAU,CAAC,gBAAgB,CAAC,CAAA;IAC5C,IAAI,CAAC,OAAO;QAAE,MAAM,IAAI,KAAK,CAAC,oFAAoF,CAAC,CAAA;IAEnH,MAAM,EAAE,KAAK,EAAE,GAAG,OAAO,CAAA;IAEzB,MAAM,GAAG,GAAG,CAAC,WAA6B,EAAE,EAAE;QAC7C,KAAK,CAAC,KAAK,GAAG,EAAE,GAAG,KAAK,CAAC,IAAI,EAAE,EAAE,IAAI,EAAE,CAAC,GAAG,KAAK,CAAC,IAAI,EAAE,CAAC,IAAI,EAAE,WAAW,CAAC,EAAE,CAAA;IAC7E,CAAC,CAAA;IAED,OAAO,EAAE,KAAK,EAAE,GAAG,EAAE,CAAA;AACtB,CAAC","sourcesContent":["import { Signal, useSignal } from '@preact/signals'\nimport { ComponentChildren, createContext } from 'preact'\nimport { useContext } from 'preact/hooks'\nimport { TEMPLATES_CACHE_KEY } from '../library/constants.js'\nimport { persistSignalEffect } from '../library/persistent-signal.js'\nimport { createCacheParser, TemplatesCache, TemplatesCacheSchema, TransferTemplate } from '../schema.js'\n\nexport type TemplatesContext = {\n\tcache: Signal<TemplatesCache>\n}\n\nexport const TemplatesContext = createContext<TemplatesContext | undefined>(undefined)\nexport const TemplatesProvider = ({ children }: { children: ComponentChildren }) => {\n\tconst cache = useSignal<TemplatesCache>({ data: [], version: '1.0.0' })\n\n\tpersistSignalEffect(TEMPLATES_CACHE_KEY, cache, createCacheParser(TemplatesCacheSchema))\n\n\treturn (\n\t\t<TemplatesContext.Provider value={{ cache }}>\n\t\t\t{children}\n\t\t</TemplatesContext.Provider>\n\t)\n}\n\nexport function useTemplates() {\n\tconst context = useContext(TemplatesContext)\n\tif (!context) throw new Error('useTransferTemplates can only be used within children of TransferTemplatesProfider')\n\n\tconst { cache } = context\n\n\tconst add = (newTemplate: TransferTemplate) => {\n\t\tcache.value = { ...cache.peek(), data: [...cache.peek().data, newTemplate] }\n\t}\n\n\treturn { cache, add }\n}\n"]}