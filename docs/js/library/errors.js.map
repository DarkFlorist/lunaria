{"version":3,"file":"errors.js","sourceRoot":"","sources":["../../ts/library/errors.ts"],"names":[],"mappings":"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","sourcesContent":["import { ActionRejectedError, NetworkError, TimeoutError, CancelledError, NumericFaultError, MissingArgumentError, CallExceptionError, TransactionReplacedError, ReplacementUnderpricedError, UnconfiguredNameError, UnexpectedArgumentError, InvalidArgumentError, BufferOverrunError, BadDataError, ServerError, NotImplementedError, UnknownError, UnsupportedOperationError, InsufficientFundsError, NonceExpiredError, OffchainFaultError } from 'ethers'\nimport { assertUnreachable } from './utilities.js'\n\ntype EthersError = (UnknownError & { code: 'UNKNOWN_ERROR' })\n\t| (NotImplementedError & { code: 'NOT_IMPLEMENTED' })\n\t| (UnsupportedOperationError & { code: 'UNSUPPORTED_OPERATION' })\n\t| (NetworkError & { code: 'NETWORK_ERROR' })\n\t| (ServerError & { code: 'SERVER_ERROR' })\n\t| (TimeoutError & { code: 'TIMEOUT' })\n\t| (BadDataError & { code: 'BAD_DATA' })\n\t| (CancelledError & { code: 'CANCELLED' })\n\t| (BufferOverrunError & { code: 'BUFFER_OVERRUN' })\n\t| (NumericFaultError & { code: 'NUMERIC_FAULT' })\n\t| (InvalidArgumentError & { code: 'INVALID_ARGUMENT' })\n\t| (MissingArgumentError & { code: 'MISSING_ARGUMENT' })\n\t| (UnexpectedArgumentError & { code: 'UNEXPECTED_ARGUMENT' })\n\t| (CallExceptionError & { code: 'CALL_EXCEPTION' })\n\t| (InsufficientFundsError & { code: 'INSUFFICIENT_FUNDS' })\n\t| (NonceExpiredError & { code: 'NONCE_EXPIRED' })\n\t| (OffchainFaultError & { code: 'OFFCHAIN_FAULT' })\n\t| (ReplacementUnderpricedError & { code: 'REPLACEMENT_UNDERPRICED' })\n\t| (TransactionReplacedError & { code: 'TRANSACTION_REPLACED' })\n\t| (UnconfiguredNameError & { code: 'UNCONFIGURED_NAME' })\n\t| (ActionRejectedError & { code: 'ACTION_REJECTED' })\n\nconst ethersErrorCodes = ['UNKNOWN_ERROR', 'NOT_IMPLEMENTED', 'UNSUPPORTED_OPERATION', 'NETWORK_ERROR', 'SERVER_ERROR', 'TIMEOUT', 'BAD_DATA', 'CANCELLED', 'BUFFER_OVERRUN', 'NUMERIC_FAULT', 'INVALID_ARGUMENT', 'MISSING_ARGUMENT', 'UNEXPECTED_ARGUMENT', 'CALL_EXCEPTION', 'INSUFFICIENT_FUNDS', 'NONCE_EXPIRED', 'OFFCHAIN_FAULT', 'REPLACEMENT_UNDERPRICED', 'TRANSACTION_REPLACED', 'UNCONFIGURED_NAME', 'ACTION_REJECTED'] as const\ntype EthersErrorCode = typeof ethersErrorCodes[number]\n\nexport function isEthersError(error: unknown): error is EthersError {\n\tif (typeof error !== 'object') return false\n\tif (error === null) return false\n\tif (!('code' in error)) return false\n\tif (typeof error.code !== 'string') return false\n\tif (!ethersErrorCodes.includes(error.code as EthersErrorCode)) return false\n\treturn true\n}\n\nexport type HumanReadableError = { message: string, warning: boolean }\n\nexport function humanReadableEthersError(error: EthersError): HumanReadableError {\n\tswitch (error.code) {\n\t\t// Generic Errors\n\t\tcase 'UNKNOWN_ERROR':\n\t\t\tconsole.error('Found UNKNOWN_ERROR error: ', error)\n\t\t\treturn { warning: true, message: `Unknown Error: ${typeof error === 'string' ? error : JSON.stringify(error)}` }\n\t\tcase 'NOT_IMPLEMENTED':\n\t\t\tconsole.error('Found NOT_IMPLEMENTED Error: ', error)\n\t\t\treturn { warning: true, message: `Error with EthersJS: \"${error.info ? JSON.stringify(error.info) : ''}\". This is a bug and you should report it.` }\n\t\tcase 'UNSUPPORTED_OPERATION':\n\t\t\treturn { warning: true, message: `Attempted to execute an unsupported operation: \"${error.info ? JSON.stringify(error.info) : ''}\". This is a bug and you should report it.` }\n\t\tcase 'SERVER_ERROR':\n\t\t\treturn { warning: true, message: `Could not communicate with server. ${error.info ? JSON.stringify(error.info) : ''}` }\n\t\tcase 'TIMEOUT':\n\t\t\treturn { warning: true, message: `Timeout during action \"${error.operation}\". ${error.reason}` }\n\t\tcase 'BAD_DATA':\n\t\t\treturn { warning: true, message: `EthersJS tried failed to understand this value: ${JSON.stringify(error.value)}. This is likely a bug and you should report it.` }\n\t\tcase 'CANCELLED':\n\t\t\treturn { warning: false, message: `Request was canceled by app. ${error.info ? JSON.stringify(error.info) : ''}` }\n\t\t// Operational Errors\n\t\tcase 'BUFFER_OVERRUN':\n\t\t\treturn { warning: true, message: `Buffer overrun. This likely a bug and you should report it. ${error.info ? JSON.stringify(error.info) : ''}` }\n\t\tcase 'NUMERIC_FAULT':\n\t\t\treturn { warning: true, message: `Failed to ${error.operation}. ${error.fault} with value ${error.value}` }\n\t\t// Argument Errors\n\t\tcase 'INVALID_ARGUMENT':\n\t\t\treturn { warning: true, message: `EthersJS received an invalid argument, \"${error.argument}\" with value ${JSON.stringify(error.value)}. This is a bug and you should report it. ${error.stack ?? ''}` }\n\t\tcase 'MISSING_ARGUMENT':\n\t\t\treturn { warning: true, message: `EthersJS expected ${error.count} arguments and received ${error.expectedCount}. This is a bug and you should report it. ${error.stack ?? ''}` }\n\t\tcase 'UNEXPECTED_ARGUMENT':\n\t\t\treturn { warning: true, message: `EthersJS received too many arguments. This is a bug and you should report it. ${error.stack ?? ''}` }\n\t\t// Blockchain Errors\n\t\tcase 'CALL_EXCEPTION':\n\t\t\tconsole.error('Encountered CALL_EXCEPTION Error', error)\n\t\t\tif (error.receipt) {\n\t\t\t\treturn { warning: true, message: `Transaction was included in block #${error.receipt.blockNumber} but reverted${error.reason ? ` with error: ${error.reason}` : ''}` }\n\t\t\t} else {\n\t\t\t\treturn { warning: true, message: error.reason ? `Transaction will fail. Call exeception during ${error.action}: ${error.reason}` : `The transaction will revert. ${error.reason ?? ''}` }\n\t\t\t}\n\t\tcase 'INSUFFICIENT_FUNDS':\n\t\t\treturn { warning: true, message: `Account ${error.transaction.from} does not have enough funds for this transaction.` }\n\t\tcase 'NONCE_EXPIRED':\n\t\t\treturn { warning: true, message: `The transaction from ${error.transaction.from} got replaced by a transaction with the same nonce.` }\n\t\tcase 'REPLACEMENT_UNDERPRICED':\n\t\t\treturn { warning: true, message: `The replacement transaction is underpriced.` }\n\t\tcase 'TRANSACTION_REPLACED':\n\t\t\treturn { warning: true, message: `The transaction got replaced by a transaction with the same nonce` }\n\t\tcase 'UNCONFIGURED_NAME':\n\t\t\treturn { warning: true, message: `Could not find ${error.value}. This ENS address may not be registered.` }\n\t\tcase 'OFFCHAIN_FAULT':\n\t\t\treturn { warning: true, message: `Offchain CCIP Error: ${error.reason}` }\n\t\t// User Interaction Errors\n\t\tcase 'ACTION_REJECTED':\n\t\t\treturn { warning: false, message: 'User rejected the request' }\n\t\tdefault:\n\t\t\tconsole.error('Found unknown error: ', error)\n\t\t\treturn { warning: true, message: `Unknown Error: ${typeof error === 'string' ? error : JSON.stringify(error)}` }\n\t}\n}\n\n/*\n * https://eips.ethereum.org/EIPS/eip-1474#error-codes\n * */\nconst jsonRpcErrorCodes = [-32002, 4100, 4900] as const\ntype JsonRpcErrorCode = typeof jsonRpcErrorCodes[number]\ntype JsonRpcError = Error & { code: JsonRpcErrorCode }\n\nexport function isJsonRpcError(error: unknown): error is JsonRpcError {\n\tif (typeof error !== 'object') return false\n\tif (error === null) return false\n\tif (!('code' in error)) return false\n\tif (typeof error.code !== 'number') return false\n\tif (!jsonRpcErrorCodes.includes(error.code as JsonRpcErrorCode)) return false\n\treturn true\n}\n\nexport function humanReadableJsonRpcError(error: JsonRpcError): HumanReadableError {\n\tswitch(error.code) {\n\t\tcase -32002:\n\t\t\treturn { warning: false, message: 'A pending request to connect is awaiting response. Check your wallet for more information.' }\n\t\tcase 4100:\n\t\t\treturn { warning: false, message: 'The requested method and/or account has not been authorized by the user.' }\n\t\tcase 4900:\n\t\t\treturn { warning: false, message: 'No compatible web3 wallet was detected.' }\n\t\tdefault:\n\t\t\tassertUnreachable(error.code)\n\t}\n}\n"]}